# AI 翻譯功能母語化品質改進指南

## 📋 改進概述

本次改進針對 RelayGo 平台的 AI 翻譯功能，解決了直譯問題，大幅提升母語化翻譯品質。

### 問題分析

**改進前的問題：**
- ❌ 錯誤範例：「新年快樂」→ 日文 = 「新年おめでとうございます」（生硬直譯）
- ❌ 錯誤範例：「謝謝」→ 日文 = 「感謝します」（字典式翻譯）
- ❌ 錯誤範例：「吃飽了嗎？」→ 日文 = 「食べましたか？」（忽略文化語境）

**改進後的效果：**
- ✅ 正確範例：「新年快樂」→ 日文 = 「あけましておめでとうございます」（母語化表達）
- ✅ 正確範例：「謝謝」→ 日文 = 「ありがとうございます」（自然表達）
- ✅ 正確範例：「吃飽了嗎？」→ 日文 = 「お元気ですか？」（功能對等翻譯）

---

## 🎯 核心改進內容

### 1. 設定專業翻譯官人格

將 AI 從簡單的「翻譯工具」提升為「20 年經驗的同聲傳譯專家」：

```javascript
// System Prompt 改進
🎯 ROLE: You are a world-renowned simultaneous interpreter with 20+ years 
of experience in cultural equivalence translation. Your expertise is making 
translations sound EXACTLY like a native speaker wrote them, not like a translation.
```

**關鍵特點：**
- 強調「文化對等翻譯」專業能力
- 明確目標：譯文必須與母語人士的表達無法區分
- 將直譯定義為「失敗」，提高 AI 對品質的重視

### 2. 明確的翻譯約束規則

#### 🚫 絕對禁止的行為：
1. **禁止詞對詞直接對應翻譯**
   - 不允許機械式的字典查詢翻譯
   
2. **禁止使用「沒人這樣說」的不自然句子**
   - 即使文法正確，但母語人士不會使用的表達一律禁止
   
3. **禁止忽略文化差異**
   - 必須考慮目標語言的文化背景和語言習慣
   
4. **禁止對成語、俚語、社交用語使用字典翻譯**
   - 這些表達必須找到功能對等的慣用語

#### ✅ 必須遵循的規則：
1. **使用目標語言的日常表達**
   - 必須使用母語人士在日常對話中實際使用的表達方式
   
2. **文化對等翻譯**
   - 成語、俚語、社交客套語必須使用目標語言中功能相同的慣用表達
   
3. **母語人士測試標準**
   - 譯文必須通過「母語人士測試」：讀起來像原創，而非翻譯
   
4. **自然表達優先於字面準確**
   - 100% 的情況下，自然表達的優先級高於字面準確性

### 3. 具體翻譯範例指導

提供了多個具體範例，幫助 AI 理解正確的翻譯模式：

#### 範例 1：新年祝福（中文 → 日文）
```
輸入：「新年快樂」
❌ 禁止（直譯）：「新年おめでとうございます」
✅ 正確（母語化）：「あけましておめでとうございます」
原因：日本文化中使用「あけましておめでとうございます」作為新年祝福
```

#### 範例 2：感謝表達（中文 → 日文）
```
輸入：「謝謝」
❌ 禁止（直譯）：「感謝します」
✅ 正確（母語化）：「ありがとうございます」
原因：「ありがとうございます」是日本人日常使用的自然表達
```

#### 範例 3：問候語（英文 → 中文）
```
輸入：「How are you?」
❌ 禁止（直譯）：「你怎麼樣？」
✅ 正確（母語化）：「你好嗎？」或「最近怎麼樣？」
原因：中文使用者會用這些自然的問候語
```

#### 範例 4：文化問候（中文 → 日文）
```
輸入：「吃飽了嗎？」
❌ 禁止（直譯）：「食べましたか？」
✅ 正確（功能對等）：「お元気ですか？」或「調子はどうですか？」
原因：這是中文的文化問候語，應翻譯其功能（關心對方），而非字面意思
```

---

## 🔄 翻譯流程改進

### 專業翻譯流程（4 步驟）：

1. **分析階段（ANALYZE）**
   - 識別溝通意圖和文化語境（而非僅僅是文字）
   
2. **思考階段（THINK）**
   - 問自己：「目標語言的母語人士在這種情況下會怎麼說？」
   
3. **翻譯階段（TRANSLATE）**
   - 使用那個自然的表達（即使與原文字面意思完全不同）
   
4. **驗證階段（VERIFY）**
   - 檢查：這聽起來像母語人士會說的話嗎？如果不是 → 修改

### 品質檢查標準：

**母語人士測試（Native Speaker Test）：**
- 如果母語人士閱讀譯文，應該認為這是用他們的語言原創寫成的
- 如果聽起來像翻譯，則視為失敗

---

## 📊 技術實作細節

### 修改的文件：
- `firebase/functions/src/services/translationService.js`

### 關鍵參數設定：
```javascript
this.model = 'gpt-4o-mini';           // OpenAI 模型
this.temperature = 0.7;                // 提高創造性以獲得更自然的翻譯
this.maxTokens = 500;                  // 最大 token 數
```

### 支援的語言：
- 繁體中文 (zh-TW)
- English (en)
- 日本語 (ja)
- 한국어 (ko)
- ไทย (th)
- Tiếng Việt (vi)
- Bahasa Indonesia (id)
- Bahasa Melayu (ms)

---

## 🚀 部署資訊

### API 端點：
```
https://asia-east1-ride-platform-f1676.cloudfunctions.net/translate
```

### 部署命令：
```bash
cd firebase/functions
firebase deploy --only functions:translate
```

### 環境變數：
- `OPENAI_API_KEY`: 從 Google Cloud Secret Manager 自動載入
- Secret 路徑: `projects/930299492291/secrets/OPENAI_API_KEY/versions/latest`

---

## 📈 預期效果

### 翻譯品質提升：
- ✅ 消除生硬的直譯表達
- ✅ 提供文化適應的自然翻譯
- ✅ 改善用戶體驗和溝通效果
- ✅ 減少因翻譯不當造成的誤解

### 適用場景：
- 即時聊天訊息翻譯
- 推播通知多語言支援
- 用戶介面文字本地化
- 客服溝通翻譯

---

## 🎓 最佳實踐建議

1. **定期更新範例**：隨著使用經驗累積，持續添加新的翻譯範例
2. **監控翻譯品質**：收集用戶反饋，識別需要改進的翻譯模式
3. **文化顧問審核**：對於關鍵場景，建議由母語人士審核翻譯品質
4. **A/B 測試**：對比改進前後的用戶滿意度和溝通效果

---

## 📝 版本歷史

- **v2.0** (2026-01-04): 加入專業翻譯官人格和文化對等翻譯規則
- **v1.0** (2025-11-30): 初始版本，基本翻譯功能

---

## 🔗 相關資源

- [OpenAI API 文檔](https://platform.openai.com/docs)
- [Firebase Functions 文檔](https://firebase.google.com/docs/functions)
- [翻譯服務源碼](./src/services/translationService.js)

